<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: OptionLab::Plotting
  
    &mdash; OptionLab Documentation
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "OptionLab::Plotting";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (P)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../OptionLab.html" title="OptionLab (module)">OptionLab</a></span></span>
     &raquo; 
    <span class="title">Plotting</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Module: OptionLab::Plotting
  
  
  
</h1>
<div class="box_info">
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/option_lab/plotting.rb</dd>
  </dl>
  
</div>








  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#plot_pl-class_method" title="plot_pl (class method)">.<strong>plot_pl</strong>(outputs)  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Plot profit/loss diagram.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="plot_pl-class_method">
  
    .<strong>plot_pl</strong>(outputs)  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p><p>Plot profit/loss diagram</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>outputs</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Models/Outputs.html" title="OptionLab::Models::Outputs (class)">Models::Outputs</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>Strategy outputs</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/option_lab/plotting.rb', line 11</span>

<span class='kw'>def</span> <span class='id identifier rubyid_plot_pl'>plot_pl</span><span class='lparen'>(</span><span class='id identifier rubyid_outputs'>outputs</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_st'>st</span> <span class='op'>=</span> <span class='id identifier rubyid_outputs'>outputs</span><span class='period'>.</span><span class='id identifier rubyid_data'>data</span>
  <span class='id identifier rubyid_inputs'>inputs</span> <span class='op'>=</span> <span class='id identifier rubyid_outputs'>outputs</span><span class='period'>.</span><span class='id identifier rubyid_inputs'>inputs</span>
  
  <span class='kw'>if</span> <span class='id identifier rubyid_st'>st</span><span class='period'>.</span><span class='id identifier rubyid_strategy_profit'>strategy_profit</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>==</span> <span class='int'>0</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>RuntimeError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Before plotting the profit/loss profile diagram, you must run a calculation!</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  
  <span class='comment'># Extract data
</span>  <span class='id identifier rubyid_stock_prices'>stock_prices</span> <span class='op'>=</span> <span class='id identifier rubyid_st'>st</span><span class='period'>.</span><span class='id identifier rubyid_stock_price_array'>stock_price_array</span>
  <span class='id identifier rubyid_strategy_profit'>strategy_profit</span> <span class='op'>=</span> <span class='id identifier rubyid_st'>st</span><span class='period'>.</span><span class='id identifier rubyid_strategy_profit'>strategy_profit</span>
  <span class='id identifier rubyid_zero_line'>zero_line</span> <span class='op'>=</span> <span class='const'>Numo</span><span class='op'>::</span><span class='const'>DFloat</span><span class='period'>.</span><span class='id identifier rubyid_zeros'>zeros</span><span class='lparen'>(</span><span class='id identifier rubyid_stock_prices'>stock_prices</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='rparen'>)</span>
  
  <span class='comment'># Process strikes and organize marker data
</span>  <span class='id identifier rubyid_strike_call_buy'>strike_call_buy</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_strike_put_buy'>strike_put_buy</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_zero_call_buy'>zero_call_buy</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_zero_put_buy'>zero_put_buy</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_strike_call_sell'>strike_call_sell</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_strike_put_sell'>strike_put_sell</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_zero_call_sell'>zero_call_sell</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_zero_put_sell'>zero_put_sell</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  
  <span class='comment'># Create plot comment
</span>  <span class='id identifier rubyid_comment'>comment</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Profit/Loss diagram:\n--------------------\n</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_comment'>comment</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>The vertical green dashed line corresponds to the position </span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_comment'>comment</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>of the stock&#39;s spot price. The right and left arrow </span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_comment'>comment</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>markers indicate the strike prices of calls and puts, </span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_comment'>comment</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>respectively, with blue representing long and red representing </span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_comment'>comment</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>short positions.</span><span class='tstring_end'>&quot;</span></span>
  
  <span class='comment'># Process each strike price
</span>  <span class='id identifier rubyid_st'>st</span><span class='period'>.</span><span class='id identifier rubyid_strike'>strike</span><span class='period'>.</span><span class='id identifier rubyid_each_with_index'>each_with_index</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_strike'>strike</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
    <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_strike'>strike</span> <span class='op'>==</span> <span class='float'>0.0</span>
    
    <span class='kw'>case</span> <span class='id identifier rubyid_st'>st</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span>
    <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>call</span><span class='tstring_end'>&#39;</span></span>
      <span class='kw'>if</span> <span class='id identifier rubyid_st'>st</span><span class='period'>.</span><span class='id identifier rubyid_action'>action</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>buy</span><span class='tstring_end'>&#39;</span></span>
        <span class='id identifier rubyid_strike_call_buy'>strike_call_buy</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_strike'>strike</span>
        <span class='id identifier rubyid_zero_call_buy'>zero_call_buy</span> <span class='op'>&lt;&lt;</span> <span class='float'>0.0</span>
      <span class='kw'>elsif</span> <span class='id identifier rubyid_st'>st</span><span class='period'>.</span><span class='id identifier rubyid_action'>action</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>sell</span><span class='tstring_end'>&#39;</span></span>
        <span class='id identifier rubyid_strike_call_sell'>strike_call_sell</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_strike'>strike</span>
        <span class='id identifier rubyid_zero_call_sell'>zero_call_sell</span> <span class='op'>&lt;&lt;</span> <span class='float'>0.0</span>
      <span class='kw'>end</span>
    <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>put</span><span class='tstring_end'>&#39;</span></span>
      <span class='kw'>if</span> <span class='id identifier rubyid_st'>st</span><span class='period'>.</span><span class='id identifier rubyid_action'>action</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>buy</span><span class='tstring_end'>&#39;</span></span>
        <span class='id identifier rubyid_strike_put_buy'>strike_put_buy</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_strike'>strike</span>
        <span class='id identifier rubyid_zero_put_buy'>zero_put_buy</span> <span class='op'>&lt;&lt;</span> <span class='float'>0.0</span>
      <span class='kw'>elsif</span> <span class='id identifier rubyid_st'>st</span><span class='period'>.</span><span class='id identifier rubyid_action'>action</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>sell</span><span class='tstring_end'>&#39;</span></span>
        <span class='id identifier rubyid_strike_put_sell'>strike_put_sell</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_strike'>strike</span>
        <span class='id identifier rubyid_zero_put_sell'>zero_put_sell</span> <span class='op'>&lt;&lt;</span> <span class='float'>0.0</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Handle profit target and loss limit lines
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_inputs'>inputs</span><span class='period'>.</span><span class='id identifier rubyid_profit_target'>profit_target</span>
    <span class='id identifier rubyid_comment'>comment</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> The blue dashed line represents the profit target level.</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_target_line'>target_line</span> <span class='op'>=</span> <span class='const'>Numo</span><span class='op'>::</span><span class='const'>DFloat</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_stock_prices'>stock_prices</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_fill'>fill</span><span class='lparen'>(</span><span class='id identifier rubyid_inputs'>inputs</span><span class='period'>.</span><span class='id identifier rubyid_profit_target'>profit_target</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  
  <span class='kw'>if</span> <span class='id identifier rubyid_inputs'>inputs</span><span class='period'>.</span><span class='id identifier rubyid_loss_limit'>loss_limit</span>
    <span class='id identifier rubyid_comment'>comment</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> The red dashed line represents the loss limit level.</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_loss_line'>loss_line</span> <span class='op'>=</span> <span class='const'>Numo</span><span class='op'>::</span><span class='const'>DFloat</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_stock_prices'>stock_prices</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_fill'>fill</span><span class='lparen'>(</span><span class='id identifier rubyid_inputs'>inputs</span><span class='period'>.</span><span class='id identifier rubyid_loss_limit'>loss_limit</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Print comment
</span>  <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_comment'>comment</span>
  
  <span class='comment'># Create the plot
</span>  <span class='kw'>begin</span>
    <span class='const'>Gnuplot</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_gp'>gp</span><span class='op'>|</span>
      <span class='const'>Gnuplot</span><span class='op'>::</span><span class='const'>Plot</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_gp'>gp</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_plot'>plot</span><span class='op'>|</span>
        <span class='id identifier rubyid_plot'>plot</span><span class='period'>.</span><span class='id identifier rubyid_title'>title</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Options Strategy Profit/Loss</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_plot'>plot</span><span class='period'>.</span><span class='id identifier rubyid_xlabel'>xlabel</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Stock Price</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_plot'>plot</span><span class='period'>.</span><span class='id identifier rubyid_ylabel'>ylabel</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Profit/Loss</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_plot'>plot</span><span class='period'>.</span><span class='id identifier rubyid_xrange'>xrange</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>[</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_stock_prices'>stock_prices</span><span class='period'>.</span><span class='id identifier rubyid_min'>min</span><span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_stock_prices'>stock_prices</span><span class='period'>.</span><span class='id identifier rubyid_max'>max</span><span class='embexpr_end'>}</span><span class='tstring_content'>]</span><span class='tstring_end'>&quot;</span></span>
        
        <span class='comment'># Add zero line
</span>        <span class='id identifier rubyid_plot'>plot</span><span class='period'>.</span><span class='id identifier rubyid_data'>data</span> <span class='op'>&lt;&lt;</span> <span class='const'>Gnuplot</span><span class='op'>::</span><span class='const'>DataSet</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='id identifier rubyid_stock_prices'>stock_prices</span><span class='comma'>,</span> <span class='id identifier rubyid_zero_line'>zero_line</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ds'>ds</span><span class='op'>|</span>
          <span class='id identifier rubyid_ds'>ds</span><span class='period'>.</span><span class='id identifier rubyid_with'>with</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>lines</span><span class='tstring_end'>&quot;</span></span>
          <span class='id identifier rubyid_ds'>ds</span><span class='period'>.</span><span class='id identifier rubyid_linecolor'>linecolor</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>violet</span><span class='tstring_end'>&quot;</span></span>
          <span class='id identifier rubyid_ds'>ds</span><span class='period'>.</span><span class='id identifier rubyid_linewidth'>linewidth</span> <span class='op'>=</span> <span class='int'>2</span>
          <span class='id identifier rubyid_ds'>ds</span><span class='period'>.</span><span class='id identifier rubyid_linetype'>linetype</span> <span class='op'>=</span> <span class='int'>2</span>  <span class='comment'># dashed line
</span>          <span class='id identifier rubyid_ds'>ds</span><span class='period'>.</span><span class='id identifier rubyid_title'>title</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Break-even</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>end</span>
        
        <span class='comment'># Add strategy profit line
</span>        <span class='id identifier rubyid_plot'>plot</span><span class='period'>.</span><span class='id identifier rubyid_data'>data</span> <span class='op'>&lt;&lt;</span> <span class='const'>Gnuplot</span><span class='op'>::</span><span class='const'>DataSet</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='id identifier rubyid_stock_prices'>stock_prices</span><span class='comma'>,</span> <span class='id identifier rubyid_strategy_profit'>strategy_profit</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ds'>ds</span><span class='op'>|</span>
          <span class='id identifier rubyid_ds'>ds</span><span class='period'>.</span><span class='id identifier rubyid_with'>with</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>lines</span><span class='tstring_end'>&quot;</span></span>
          <span class='id identifier rubyid_ds'>ds</span><span class='period'>.</span><span class='id identifier rubyid_linecolor'>linecolor</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>black</span><span class='tstring_end'>&quot;</span></span>
          <span class='id identifier rubyid_ds'>ds</span><span class='period'>.</span><span class='id identifier rubyid_linewidth'>linewidth</span> <span class='op'>=</span> <span class='int'>3</span>
          <span class='id identifier rubyid_ds'>ds</span><span class='period'>.</span><span class='id identifier rubyid_title'>title</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Strategy P/L</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>end</span>
        
        <span class='comment'># Add vertical line at current stock price
</span>        <span class='id identifier rubyid_plot'>plot</span><span class='period'>.</span><span class='id identifier rubyid_data'>data</span> <span class='op'>&lt;&lt;</span> <span class='const'>Gnuplot</span><span class='op'>::</span><span class='const'>DataSet</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span>
          <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_inputs'>inputs</span><span class='period'>.</span><span class='id identifier rubyid_stock_price'>stock_price</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_inputs'>inputs</span><span class='period'>.</span><span class='id identifier rubyid_stock_price'>stock_price</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_strategy_profit'>strategy_profit</span><span class='period'>.</span><span class='id identifier rubyid_min'>min</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_strategy_profit'>strategy_profit</span><span class='period'>.</span><span class='id identifier rubyid_max'>max</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
        <span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ds'>ds</span><span class='op'>|</span>
          <span class='id identifier rubyid_ds'>ds</span><span class='period'>.</span><span class='id identifier rubyid_with'>with</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>lines</span><span class='tstring_end'>&quot;</span></span>
          <span class='id identifier rubyid_ds'>ds</span><span class='period'>.</span><span class='id identifier rubyid_linecolor'>linecolor</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>green</span><span class='tstring_end'>&quot;</span></span>
          <span class='id identifier rubyid_ds'>ds</span><span class='period'>.</span><span class='id identifier rubyid_linewidth'>linewidth</span> <span class='op'>=</span> <span class='int'>2</span>
          <span class='id identifier rubyid_ds'>ds</span><span class='period'>.</span><span class='id identifier rubyid_linetype'>linetype</span> <span class='op'>=</span> <span class='int'>2</span>  <span class='comment'># dashed line
</span>          <span class='id identifier rubyid_ds'>ds</span><span class='period'>.</span><span class='id identifier rubyid_title'>title</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Current Price</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>end</span>
        
        <span class='comment'># Add profit target line if present
</span>        <span class='kw'>if</span> <span class='id identifier rubyid_inputs'>inputs</span><span class='period'>.</span><span class='id identifier rubyid_profit_target'>profit_target</span>
          <span class='id identifier rubyid_plot'>plot</span><span class='period'>.</span><span class='id identifier rubyid_data'>data</span> <span class='op'>&lt;&lt;</span> <span class='const'>Gnuplot</span><span class='op'>::</span><span class='const'>DataSet</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='id identifier rubyid_stock_prices'>stock_prices</span><span class='comma'>,</span> <span class='id identifier rubyid_target_line'>target_line</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ds'>ds</span><span class='op'>|</span>
            <span class='id identifier rubyid_ds'>ds</span><span class='period'>.</span><span class='id identifier rubyid_with'>with</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>lines</span><span class='tstring_end'>&quot;</span></span>
            <span class='id identifier rubyid_ds'>ds</span><span class='period'>.</span><span class='id identifier rubyid_linecolor'>linecolor</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>blue</span><span class='tstring_end'>&quot;</span></span>
            <span class='id identifier rubyid_ds'>ds</span><span class='period'>.</span><span class='id identifier rubyid_linewidth'>linewidth</span> <span class='op'>=</span> <span class='int'>2</span>
            <span class='id identifier rubyid_ds'>ds</span><span class='period'>.</span><span class='id identifier rubyid_linetype'>linetype</span> <span class='op'>=</span> <span class='int'>2</span>  <span class='comment'># dashed line
</span>            <span class='id identifier rubyid_ds'>ds</span><span class='period'>.</span><span class='id identifier rubyid_title'>title</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Profit Target</span><span class='tstring_end'>&quot;</span></span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
        
        <span class='comment'># Add loss limit line if present
</span>        <span class='kw'>if</span> <span class='id identifier rubyid_inputs'>inputs</span><span class='period'>.</span><span class='id identifier rubyid_loss_limit'>loss_limit</span>
          <span class='id identifier rubyid_plot'>plot</span><span class='period'>.</span><span class='id identifier rubyid_data'>data</span> <span class='op'>&lt;&lt;</span> <span class='const'>Gnuplot</span><span class='op'>::</span><span class='const'>DataSet</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='id identifier rubyid_stock_prices'>stock_prices</span><span class='comma'>,</span> <span class='id identifier rubyid_loss_line'>loss_line</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ds'>ds</span><span class='op'>|</span>
            <span class='id identifier rubyid_ds'>ds</span><span class='period'>.</span><span class='id identifier rubyid_with'>with</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>lines</span><span class='tstring_end'>&quot;</span></span>
            <span class='id identifier rubyid_ds'>ds</span><span class='period'>.</span><span class='id identifier rubyid_linecolor'>linecolor</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>red</span><span class='tstring_end'>&quot;</span></span>
            <span class='id identifier rubyid_ds'>ds</span><span class='period'>.</span><span class='id identifier rubyid_linewidth'>linewidth</span> <span class='op'>=</span> <span class='int'>2</span>
            <span class='id identifier rubyid_ds'>ds</span><span class='period'>.</span><span class='id identifier rubyid_linetype'>linetype</span> <span class='op'>=</span> <span class='int'>2</span>  <span class='comment'># dashed line
</span>            <span class='id identifier rubyid_ds'>ds</span><span class='period'>.</span><span class='id identifier rubyid_title'>title</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Loss Limit</span><span class='tstring_end'>&quot;</span></span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
        
        <span class='comment'># Add markers for call and put strikes
</span>        <span class='kw'>if</span> <span class='id identifier rubyid_strike_call_buy'>strike_call_buy</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span>
          <span class='id identifier rubyid_plot'>plot</span><span class='period'>.</span><span class='id identifier rubyid_data'>data</span> <span class='op'>&lt;&lt;</span> <span class='const'>Gnuplot</span><span class='op'>::</span><span class='const'>DataSet</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='id identifier rubyid_strike_call_buy'>strike_call_buy</span><span class='comma'>,</span> <span class='id identifier rubyid_zero_call_buy'>zero_call_buy</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ds'>ds</span><span class='op'>|</span>
            <span class='id identifier rubyid_ds'>ds</span><span class='period'>.</span><span class='id identifier rubyid_with'>with</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>points</span><span class='tstring_end'>&quot;</span></span>
            <span class='id identifier rubyid_ds'>ds</span><span class='period'>.</span><span class='id identifier rubyid_pointtype'>pointtype</span> <span class='op'>=</span> <span class='int'>9</span>  <span class='comment'># right arrow
</span>            <span class='id identifier rubyid_ds'>ds</span><span class='period'>.</span><span class='id identifier rubyid_pointsize'>pointsize</span> <span class='op'>=</span> <span class='int'>2</span>
            <span class='id identifier rubyid_ds'>ds</span><span class='period'>.</span><span class='id identifier rubyid_linecolor'>linecolor</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>blue</span><span class='tstring_end'>&quot;</span></span>
            <span class='id identifier rubyid_ds'>ds</span><span class='period'>.</span><span class='id identifier rubyid_title'>title</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Long Calls</span><span class='tstring_end'>&quot;</span></span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
        
        <span class='kw'>if</span> <span class='id identifier rubyid_strike_put_buy'>strike_put_buy</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span>
          <span class='id identifier rubyid_plot'>plot</span><span class='period'>.</span><span class='id identifier rubyid_data'>data</span> <span class='op'>&lt;&lt;</span> <span class='const'>Gnuplot</span><span class='op'>::</span><span class='const'>DataSet</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='id identifier rubyid_strike_put_buy'>strike_put_buy</span><span class='comma'>,</span> <span class='id identifier rubyid_zero_put_buy'>zero_put_buy</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ds'>ds</span><span class='op'>|</span>
            <span class='id identifier rubyid_ds'>ds</span><span class='period'>.</span><span class='id identifier rubyid_with'>with</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>points</span><span class='tstring_end'>&quot;</span></span>
            <span class='id identifier rubyid_ds'>ds</span><span class='period'>.</span><span class='id identifier rubyid_pointtype'>pointtype</span> <span class='op'>=</span> <span class='int'>8</span>  <span class='comment'># left arrow
</span>            <span class='id identifier rubyid_ds'>ds</span><span class='period'>.</span><span class='id identifier rubyid_pointsize'>pointsize</span> <span class='op'>=</span> <span class='int'>2</span>
            <span class='id identifier rubyid_ds'>ds</span><span class='period'>.</span><span class='id identifier rubyid_linecolor'>linecolor</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>blue</span><span class='tstring_end'>&quot;</span></span>
            <span class='id identifier rubyid_ds'>ds</span><span class='period'>.</span><span class='id identifier rubyid_title'>title</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Long Puts</span><span class='tstring_end'>&quot;</span></span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
        
        <span class='kw'>if</span> <span class='id identifier rubyid_strike_call_sell'>strike_call_sell</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span>
          <span class='id identifier rubyid_plot'>plot</span><span class='period'>.</span><span class='id identifier rubyid_data'>data</span> <span class='op'>&lt;&lt;</span> <span class='const'>Gnuplot</span><span class='op'>::</span><span class='const'>DataSet</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='id identifier rubyid_strike_call_sell'>strike_call_sell</span><span class='comma'>,</span> <span class='id identifier rubyid_zero_call_sell'>zero_call_sell</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ds'>ds</span><span class='op'>|</span>
            <span class='id identifier rubyid_ds'>ds</span><span class='period'>.</span><span class='id identifier rubyid_with'>with</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>points</span><span class='tstring_end'>&quot;</span></span>
            <span class='id identifier rubyid_ds'>ds</span><span class='period'>.</span><span class='id identifier rubyid_pointtype'>pointtype</span> <span class='op'>=</span> <span class='int'>9</span>  <span class='comment'># right arrow
</span>            <span class='id identifier rubyid_ds'>ds</span><span class='period'>.</span><span class='id identifier rubyid_pointsize'>pointsize</span> <span class='op'>=</span> <span class='int'>2</span>
            <span class='id identifier rubyid_ds'>ds</span><span class='period'>.</span><span class='id identifier rubyid_linecolor'>linecolor</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>red</span><span class='tstring_end'>&quot;</span></span>
            <span class='id identifier rubyid_ds'>ds</span><span class='period'>.</span><span class='id identifier rubyid_title'>title</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Short Calls</span><span class='tstring_end'>&quot;</span></span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
        
        <span class='kw'>if</span> <span class='id identifier rubyid_strike_put_sell'>strike_put_sell</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span>
          <span class='id identifier rubyid_plot'>plot</span><span class='period'>.</span><span class='id identifier rubyid_data'>data</span> <span class='op'>&lt;&lt;</span> <span class='const'>Gnuplot</span><span class='op'>::</span><span class='const'>DataSet</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='id identifier rubyid_strike_put_sell'>strike_put_sell</span><span class='comma'>,</span> <span class='id identifier rubyid_zero_put_sell'>zero_put_sell</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ds'>ds</span><span class='op'>|</span>
            <span class='id identifier rubyid_ds'>ds</span><span class='period'>.</span><span class='id identifier rubyid_with'>with</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>points</span><span class='tstring_end'>&quot;</span></span>
            <span class='id identifier rubyid_ds'>ds</span><span class='period'>.</span><span class='id identifier rubyid_pointtype'>pointtype</span> <span class='op'>=</span> <span class='int'>8</span>  <span class='comment'># left arrow
</span>            <span class='id identifier rubyid_ds'>ds</span><span class='period'>.</span><span class='id identifier rubyid_pointsize'>pointsize</span> <span class='op'>=</span> <span class='int'>2</span>
            <span class='id identifier rubyid_ds'>ds</span><span class='period'>.</span><span class='id identifier rubyid_linecolor'>linecolor</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>red</span><span class='tstring_end'>&quot;</span></span>
            <span class='id identifier rubyid_ds'>ds</span><span class='period'>.</span><span class='id identifier rubyid_title'>title</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Short Puts</span><span class='tstring_end'>&quot;</span></span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>rescue</span> <span class='const'>StandardError</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Warning: Could not create plot. </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>To use plotting functionality, please ensure gnuplot is installed.</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Sun Apr 27 16:09:34 2025 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.37 (ruby-3.3.3).
</div>

    </div>
  </body>
</html>